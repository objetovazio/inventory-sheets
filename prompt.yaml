#Instruções#

<persona>
Aja como um programador Python experiente especializado em manipulação do Planilhas Google.
</persona>

<objetivo>
Desenvolva um algoritmo que faça controle de estoque usando três 3 Planilhas Google interconectadas. Siga a estrutura detalhada e as tarefas descritas abaixo.
</objetivo>

<tarefa>
1. Planilha 1 (Estoque): Esta planilha contém o estoque completo dos itens disponíveis. Deve ter as seguintes colunas:
- Categoria: A categoria do item.
- Nome: O nome do item.
- Quantidade: A quantidade disponível em estoque.

2. Planilha 2 (Baixa de Estoque - Á processar): Esta planilha recebe dados do usuário através de uma resposta do Google Forms. Esta planilha tem as seguintes colunas:
- Data/hora de inserçao: Data e hora em que o formulário foi preenchido.
- Nome Responsável: Pessoa responsável que retirou e deu baixa no item. Responsável pelo preenchimento do Google Forms.
- Categoria: Categoria do item.
- Nome: Nome do item.
- Quantidade: Quantidade removida do estoque (baixa).
- Justificativa: Motivo da baixa do item no estoque.

3. Planilha 3 (Histórico - Itens Processados): Esta planilha é responsável por manter o histórico dos itens que levaram baixa no estoque. Deve ter as seguintes colunas:
- Data/hora de inserçao: Data e hora em que o formulário foi preenchido.
- Nome Responsável: Pessoa responsável que retirou e deu baixa no item. Responsável pelo preenchimento do Google Forms.
- Categoria: Categoria do item.
- Nome: Nome do item.
- Quantidade: Quantidade retirada do estoque.
- Justificativa: Motivo da redução.
</task>

<steps>
1. Comparação e Atualização: 
  - Validar e processar os dados do Planilha 2, verificando os itens e quantidades e atualizando o Planilha 1 adequadamente. Nome e categoria são as chaves para identificar cada item. A quantidade inserida na planilha dois deve ser deduzida da planilha 1.
  - Atualizar quantidade de itens e a data/hora da ultima atualizacao desse item na planilha 1.

2. Registro atualizar baixa de estoque: 
  - Atualizar planilha 3, inserindo as informaçoes do item que levou baixa.
  - Remover da planilha 2 itens que já foram processados. Mantendo o histórico de itens processados na planilha 3.

3. Automação: O script Python deve automatizar esse processo, podendo manipular novos dados do formulário periodicamente ou sob demanda.
</steps>

<requirements>
- Utilizar as APIs do Planilhas Google para integração e manipulação de dados.
- Garantir a validação adequada para evitar erros ao processar reduções de estoque.
</requirements>

#Fim das Instruções#